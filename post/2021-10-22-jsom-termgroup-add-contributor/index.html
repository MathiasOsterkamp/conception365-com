<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Mathias Osterkamp"><meta property="og:type" content="article"><meta property="og:image" content="/post/2021-10-22-jsom-termgroup-add-contributor/header_huf4a0530713166702484ca9ce582083fb_54113_350x0_resize_box_2.png"><meta property="twitter:image" content="/post/2021-10-22-jsom-termgroup-add-contributor/header_huf4a0530713166702484ca9ce582083fb_54113_350x0_resize_box_2.png"><meta name=title content="Site termgroup add contributor or manager"><meta property="og:title" content="Site termgroup add contributor or manager"><meta property="twitter:title" content="Site termgroup add contributor or manager"><meta name=description content><meta property="og:description" content><meta property="twitter:description" content><meta property="twitter:card" content="summary"><meta name=keyword content="SharePoint, Microsoft, Office 365, Teams, Azure, Webdevelopment"><link rel="shortcut icon" href=/%20img/favicon.ico><title>Site termgroup add contributor or manager-Mathias Osterkamp</title><link rel=canonical href=/post/2021-10-22-jsom-termgroup-add-contributor/><link rel=preload href=fonts/jost/files/jost-latin-200-normal.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=fonts/jost/files/jost-latin-400-normal.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=fonts/jost/files/jost-latin-500-normal.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://conception365.com/main.min.50bc48d2b178bdf1d99650adf9577e5e15189f3c08648f97cf6e84b934bf36bc.css><script type=text/javascript src=/js/bundle.min.e459528320f58ffacd1d26c997631f04a7c3d2ff4f6408fe8e3bc5b970f96fae.js defer></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JG6K5XRGQL"></script><script>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-JG6K5XRGQL',{anonymize_ip:!0})}</script><script async src=http://localhost:3000/tracker.js data-ackee-server=http://localhost:3000 data-ackee-opts='{ "ignoreLocalhost": false,"ignoreOwnVisits": false, "detailed": true }' data-ackee-domain-id=8d8a9a93-b756-432f-b199-8df069f35faf></script></head><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=site-heading><a href=https://conception365.com><h1>Mathias Osterkamp</h1></a><span class=subheading>Specialist â€“ focus development Microsoft technology stack</span></div></div></div></div></header><nav class="navbar navbar-default navbar-custom"><div class=container><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/categories/administration>administration</a></li><li><a href=/categories/powerapps>powerapps</a></li><li><a href=/categories/spfx>spfx</a></li><li><a href=/top/about/>ABOUT ME</a></li></ul><ul class="nav navbar-nav navbar-right"><li><a href=/search>SEARCH <img src=/img/search.png height=15 style=cursor:pointer alt=Search></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector('.navbar-toggle'),$navbar=document.querySelector('#huxblog_navbar'),$collapse=document.querySelector('.navbar-collapse');$toggle.addEventListener('click',handleMagic);function handleMagic(a){$navbar.className.indexOf('in')>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf('in')<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><article><div class=container><div class=row><div class="col-lg-8
col-md-8
post-container"><div class=post-preview><div class=penci-standard-cat><span class=cat><a class=penci-cat-name href=https://conception365.com/tags/sharepoint/ rel="category tag">SharePoint</a>
<a class=penci-cat-name href=https://conception365.com/tags/spfx/ rel="category tag">SPFX</a>
<a class=penci-cat-name href=https://conception365.com/tags/jsom/ rel="category tag">JSOM</a>
<a class=penci-cat-name href=https://conception365.com/tags/javascript/ rel="category tag">Javascript</a></span></div><a href=https://conception365.com/post/2021-10-22-jsom-termgroup-add-contributor/><h2 class=post-title>Site termgroup add contributor or manager</h2></a><h2 class=post-subtitle>Adds a manager or contributor to a SharePoint site collection termgroup</h2><span class=post-meta>Written by
Mathias Osterkamp
on
Friday, October 22, 2021</span>
<a href=header.png target=_blank><img src=/post/2021-10-22-jsom-termgroup-add-contributor/header.png></a></div><h1 id=add-site-collection-term-group-managers-and-contributors-using-jsom>Add site collection term group Managers and Contributors using JSOM</h1><p>On client side for CSOM we have already a solution for adding managers or contributors for term groups.
You can have a look <a href=https://www.vrdmn.com/2016/05/add-termstore-managers-and-contributors.html>here</a> for the original article.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#>ClientContext clientContext = GetClientContext();

<span style=color:#8be9fd>var</span> taxonomySession = TaxonomySession.GetTaxonomySession(clientContext);

<span style=color:#8be9fd>var</span> termStore = taxonomySession.GetDefaultSiteCollectionTermStore();

<span style=color:#8be9fd>var</span> myTermGroup = termStore.Groups.GetByName(<span style=color:#f1fa8c>&#34;My Custom Terms Group&#34;</span>);

<span style=color:#6272a4>//Add Group Managers
</span><span style=color:#6272a4></span>myTermGroup.AddGroupManager(<span style=color:#f1fa8c>&#34;i:0#.f|membership|...@tenant.onmicrosoft.com&#34;</span>);

<span style=color:#6272a4>//Add Group Contributors
</span><span style=color:#6272a4></span>myTermGroup.AddContributor(<span style=color:#f1fa8c>&#34;i:0#.f|membership|...@tenant.onmicrosoft.com&#34;</span>);
myTermGroup.AddContributor(<span style=color:#f1fa8c>&#34;i:0#.f|membership|...@tenant.onmicrosoft.com&#34;</span>);

clientContext.Load(myTermGroup, <span style=color:#ff79c6>group</span> =&gt; <span style=color:#ff79c6>group</span>.GroupManagerPrincipalNames, <span style=color:#ff79c6>group</span> =&gt; <span style=color:#ff79c6>group</span>.ContributorPrincipalNames);
clientContext.ExecuteQuery();

Console.WriteLine(<span style=color:#f1fa8c>&#34;Group Managers: &#34;</span>);
<span style=color:#ff79c6>foreach</span> (<span style=color:#8be9fd>var</span> manager <span style=color:#ff79c6>in</span> myTermGroup.GroupManagerPrincipalNames)
{
    Console.WriteLine(manager);
}

Console.WriteLine(<span style=color:#f1fa8c>&#34;Group Contributors: &#34;</span>);
<span style=color:#ff79c6>foreach</span> (<span style=color:#8be9fd>var</span> contributors <span style=color:#ff79c6>in</span> myTermGroup.ContributorPrincipalNames)
{
    Console.WriteLine(contributors);
}
</code></pre></div><p>I extracted the methods for the special case of site collection term group managers and contributors, you can find here a working version with pure typescript. Your class should also have a property for spHttpClient and absoluteWebUrl from <a href=https://github.com/pnp/pnpjs/>pnp js</a>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#6272a4>/**
</span><span style=color:#6272a4>   * Add manager (creates site term group if not exists, allowed to run multiple times for same user)
</span><span style=color:#6272a4>   * @param principalName name of user contoso\login or Everyone
</span><span style=color:#6272a4>   */</span>
  <span style=color:#ff79c6>public</span> <span style=color:#ff79c6>async</span> addSiteGroupManager(principalName: <span style=color:#8be9fd>string</span>)<span style=color:#ff79c6>:</span> Promise&lt;<span style=color:#ff79c6>void</span>&gt; {
    <span style=color:#ff79c6>const</span> requestBody <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>`&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span><span style=color:#f1fa8c>       &lt;Request xmlns=&#34;http://schemas.microsoft.com/sharepoint/clientquery/2009&#34; SchemaVersion=&#34;15.0.0.0&#34; LibraryVersion=&#34;16.0.0.0&#34; ApplicationName=&#34;Javascript Library&#34;&gt;
</span><span style=color:#f1fa8c>          &lt;Actions&gt;
</span><span style=color:#f1fa8c>             &lt;ObjectPath Id=&#34;1&#34; ObjectPathId=&#34;0&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;ObjectIdentityQuery Id=&#34;2&#34; ObjectPathId=&#34;0&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;ObjectPath Id=&#34;4&#34; ObjectPathId=&#34;3&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;ObjectIdentityQuery Id=&#34;5&#34; ObjectPathId=&#34;3&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;ObjectPath Id=&#34;7&#34; ObjectPathId=&#34;6&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;ObjectPath Id=&#34;9&#34; ObjectPathId=&#34;8&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;ObjectPath Id=&#34;11&#34; ObjectPathId=&#34;10&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;ObjectIdentityQuery Id=&#34;12&#34; ObjectPathId=&#34;10&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;Method Name=&#34;AddGroupManager&#34; Id=&#34;13&#34; ObjectPathId=&#34;10&#34;&gt;
</span><span style=color:#f1fa8c>                &lt;Parameters&gt;
</span><span style=color:#f1fa8c>                   &lt;Parameter Type=&#34;String&#34;&gt;</span><span style=color:#f1fa8c>${</span>principalName<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&lt;/Parameter&gt;
</span><span style=color:#f1fa8c>                &lt;/Parameters&gt;
</span><span style=color:#f1fa8c>             &lt;/Method&gt;
</span><span style=color:#f1fa8c>          &lt;/Actions&gt;
</span><span style=color:#f1fa8c>          &lt;ObjectPaths&gt;
</span><span style=color:#f1fa8c>             &lt;StaticMethod Id=&#34;0&#34; Name=&#34;GetTaxonomySession&#34; TypeId=&#34;{981cbc68-9edc-4f8d-872f-71146fcbb84f}&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;Method Id=&#34;3&#34; ParentId=&#34;0&#34; Name=&#34;GetDefaultSiteCollectionTermStore&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;StaticProperty Id=&#34;6&#34; TypeId=&#34;{3747adcd-a3c3-41b9-bfab-4a64dd2f1e0a}&#34; Name=&#34;Current&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;Property Id=&#34;8&#34; ParentId=&#34;6&#34; Name=&#34;Site&#34; /&gt;
</span><span style=color:#f1fa8c>             &lt;Method Id=&#34;10&#34; ParentId=&#34;3&#34; Name=&#34;GetSiteCollectionGroup&#34;&gt;
</span><span style=color:#f1fa8c>                &lt;Parameters&gt;
</span><span style=color:#f1fa8c>                   &lt;Parameter ObjectPathId=&#34;8&#34; /&gt;
</span><span style=color:#f1fa8c>                   &lt;Parameter Type=&#34;Boolean&#34;&gt;true&lt;/Parameter&gt;
</span><span style=color:#f1fa8c>                &lt;/Parameters&gt;
</span><span style=color:#f1fa8c>             &lt;/Method&gt;
</span><span style=color:#f1fa8c>          &lt;/ObjectPaths&gt;
</span><span style=color:#f1fa8c>       &lt;/Request&gt;`</span>;

    <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>await</span> <span style=color:#ff79c6>this</span>.postcsom(requestBody).then((result) <span style=color:#ff79c6>=&gt;</span> {
      <span style=color:#ff79c6>if</span> (result[<span style=color:#bd93f9>0</span>].ErrorInfo <span style=color:#ff79c6>!==</span> <span style=color:#ff79c6>null</span>) {
        <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> <span style=color:#8be9fd;font-style:italic>Error</span>(JSON.stringify(result[<span style=color:#bd93f9>0</span>].ErrorInfo));
      }
      <span style=color:#ff79c6>return</span>;
    });
  }

  <span style=color:#6272a4>/**
</span><span style=color:#6272a4>   * Add contributor (creates site term group if not exists, allowed to run multiple times for same user)
</span><span style=color:#6272a4>   * @param principalName name of user contoso\login or Everyone
</span><span style=color:#6272a4>   */</span>
  <span style=color:#ff79c6>public</span> <span style=color:#ff79c6>async</span> addSiteGroupContributor(principalName: <span style=color:#8be9fd>string</span>)<span style=color:#ff79c6>:</span> Promise&lt;<span style=color:#ff79c6>void</span>&gt; {
    <span style=color:#ff79c6>const</span> requestBody <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>`&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span><span style=color:#f1fa8c>      &lt;Request xmlns=&#34;http://schemas.microsoft.com/sharepoint/clientquery/2009&#34; SchemaVersion=&#34;15.0.0.0&#34; LibraryVersion=&#34;16.0.0.0&#34; ApplicationName=&#34;Javascript Library&#34;&gt;
</span><span style=color:#f1fa8c>         &lt;Actions&gt;
</span><span style=color:#f1fa8c>            &lt;ObjectPath Id=&#34;1&#34; ObjectPathId=&#34;0&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;ObjectIdentityQuery Id=&#34;2&#34; ObjectPathId=&#34;0&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;ObjectPath Id=&#34;4&#34; ObjectPathId=&#34;3&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;ObjectIdentityQuery Id=&#34;5&#34; ObjectPathId=&#34;3&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;ObjectPath Id=&#34;7&#34; ObjectPathId=&#34;6&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;ObjectPath Id=&#34;9&#34; ObjectPathId=&#34;8&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;ObjectPath Id=&#34;11&#34; ObjectPathId=&#34;10&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;ObjectIdentityQuery Id=&#34;12&#34; ObjectPathId=&#34;10&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;Method Name=&#34;AddContributor&#34; Id=&#34;13&#34; ObjectPathId=&#34;10&#34;&gt;
</span><span style=color:#f1fa8c>               &lt;Parameters&gt;
</span><span style=color:#f1fa8c>                  &lt;Parameter Type=&#34;String&#34;&gt;</span><span style=color:#f1fa8c>${</span>principalName<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>&lt;/Parameter&gt;
</span><span style=color:#f1fa8c>               &lt;/Parameters&gt;
</span><span style=color:#f1fa8c>            &lt;/Method&gt;
</span><span style=color:#f1fa8c>         &lt;/Actions&gt;
</span><span style=color:#f1fa8c>         &lt;ObjectPaths&gt;
</span><span style=color:#f1fa8c>            &lt;StaticMethod Id=&#34;0&#34; Name=&#34;GetTaxonomySession&#34; TypeId=&#34;{981cbc68-9edc-4f8d-872f-71146fcbb84f}&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;Method Id=&#34;3&#34; ParentId=&#34;0&#34; Name=&#34;GetDefaultSiteCollectionTermStore&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;StaticProperty Id=&#34;6&#34; TypeId=&#34;{3747adcd-a3c3-41b9-bfab-4a64dd2f1e0a}&#34; Name=&#34;Current&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;Property Id=&#34;8&#34; ParentId=&#34;6&#34; Name=&#34;Site&#34; /&gt;
</span><span style=color:#f1fa8c>            &lt;Method Id=&#34;10&#34; ParentId=&#34;3&#34; Name=&#34;GetSiteCollectionGroup&#34;&gt;
</span><span style=color:#f1fa8c>               &lt;Parameters&gt;
</span><span style=color:#f1fa8c>                  &lt;Parameter ObjectPathId=&#34;8&#34; /&gt;
</span><span style=color:#f1fa8c>                  &lt;Parameter Type=&#34;Boolean&#34;&gt;true&lt;/Parameter&gt;
</span><span style=color:#f1fa8c>               &lt;/Parameters&gt;
</span><span style=color:#f1fa8c>            &lt;/Method&gt;
</span><span style=color:#f1fa8c>         &lt;/ObjectPaths&gt;
</span><span style=color:#f1fa8c>      &lt;/Request&gt;`</span>;
    <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>await</span> <span style=color:#ff79c6>this</span>.postcsom(requestBody).then((result) <span style=color:#ff79c6>=&gt;</span> {
      <span style=color:#ff79c6>if</span> (result[<span style=color:#bd93f9>0</span>].ErrorInfo <span style=color:#ff79c6>!==</span> <span style=color:#ff79c6>null</span>) {
        <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> <span style=color:#8be9fd;font-style:italic>Error</span>(JSON.stringify(result[<span style=color:#bd93f9>0</span>].ErrorInfo));
      }
      <span style=color:#ff79c6>return</span>;
    });
  }


<span style=color:#6272a4>/**
</span><span style=color:#6272a4>   * sends a request to client svc
</span><span style=color:#6272a4>   * @param data request data
</span><span style=color:#6272a4>   */</span>
  <span style=color:#6272a4>// eslint-disable-next-line @typescript-eslint/no-explicit-any
</span><span style=color:#6272a4></span>  <span style=color:#ff79c6>private</span> <span style=color:#ff79c6>async</span> postcsom(data: <span style=color:#8be9fd>string</span>)<span style=color:#ff79c6>:</span> Promise&lt;<span style=color:#ff79c6>any</span>&gt; {
    <span style=color:#ff79c6>const</span> clientServiceUrl <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>this</span>.absoluteWebUrl <span style=color:#ff79c6>+</span> <span style=color:#f1fa8c>&#39;/_vti_bin/client.svc/ProcessQuery&#39;</span>;

    <span style=color:#ff79c6>const</span> formDigest <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> <span style=color:#ff79c6>this</span>.getFormDigest();

    <span style=color:#ff79c6>const</span> requestHeaders: <span style=color:#8be9fd>Headers</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Headers();
    requestHeaders.append(<span style=color:#f1fa8c>&#39;Accept&#39;</span>, <span style=color:#f1fa8c>&#39;application/json&#39;</span>);
    requestHeaders.append(<span style=color:#f1fa8c>&#39;Content-Type&#39;</span>, <span style=color:#f1fa8c>&#39;text/xml&#39;</span>);
    requestHeaders.append(<span style=color:#f1fa8c>&#39;X-RequestDigest&#39;</span>, formDigest);

    <span style=color:#ff79c6>const</span> httpPostOptions: <span style=color:#8be9fd>IHttpClientOptions</span> <span style=color:#ff79c6>=</span> {
      headers: <span style=color:#8be9fd>requestHeaders</span>,
      body: <span style=color:#8be9fd>data</span>
    };

    <span style=color:#ff79c6>const</span> serviceResponse: <span style=color:#8be9fd>IResponse</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> <span style=color:#ff79c6>this</span>.spHttpClient.post(clientServiceUrl,SPHttpClient.configurations.v1, httpPostOptions);
    <span style=color:#ff79c6>const</span> serviceJSONResponse <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> serviceResponse.json();
    <span style=color:#ff79c6>if</span> (serviceResponse.ok) {
      <span style=color:#ff79c6>return</span> serviceJSONResponse;
    }
    <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>null</span>;
  }

  <span style=color:#6272a4>/**
</span><span style=color:#6272a4>   * digest is needed for post requests
</span><span style=color:#6272a4>   */</span>
  <span style=color:#ff79c6>private</span> <span style=color:#ff79c6>async</span> getFormDigest()<span style=color:#ff79c6>:</span> Promise&lt;<span style=color:#ff79c6>string</span>&gt; {
    <span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>this</span>.cachedDigest <span style=color:#ff79c6>&amp;&amp;</span> <span style=color:#ff79c6>!</span><span style=color:#ff79c6>this</span>.isDigestDateInvalid()) <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>this</span>.cachedDigest;
    <span style=color:#ff79c6>this</span>.cachedDigestDate <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> <span style=color:#8be9fd;font-style:italic>Date</span>();
    <span style=color:#ff79c6>const</span> contextInfoUrl <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>this</span>.absoluteWebUrl <span style=color:#ff79c6>+</span> <span style=color:#f1fa8c>&#39;/_api/contextinfo&#39;</span>;

    <span style=color:#ff79c6>const</span> requestHeaders: <span style=color:#8be9fd>Headers</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Headers();
    requestHeaders.append(<span style=color:#f1fa8c>&#39;Accept&#39;</span>, <span style=color:#f1fa8c>&#39;application/json&#39;</span>);
    requestHeaders.append(<span style=color:#f1fa8c>&#39;Content-Type&#39;</span>, <span style=color:#f1fa8c>&#39;text/xml&#39;</span>);

    <span style=color:#ff79c6>const</span> httpPostOptions: <span style=color:#8be9fd>IHttpClientOptions</span> <span style=color:#ff79c6>=</span> {
      headers: <span style=color:#8be9fd>requestHeaders</span>
    };
    <span style=color:#ff79c6>const</span> contextInfoResponse: <span style=color:#8be9fd>IResponse</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> <span style=color:#ff79c6>this</span>.spHttpClient.post(contextInfoUrl, httpPostOptions);
    <span style=color:#ff79c6>const</span> contextInfoJsonResponse <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>await</span> contextInfoResponse.json();
    <span style=color:#ff79c6>const</span> formDigest: <span style=color:#8be9fd>string</span> <span style=color:#ff79c6>=</span> contextInfoJsonResponse.FormDigestValue;
    <span style=color:#ff79c6>this</span>.cachedDigest <span style=color:#ff79c6>=</span> formDigest;
    <span style=color:#ff79c6>return</span> formDigest;
  }
  
  <span style=color:#ff79c6>private</span> isDigestDateInvalid()<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>boolean</span> {
    <span style=color:#ff79c6>const</span> today <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> <span style=color:#8be9fd;font-style:italic>Date</span>().getTime();
    <span style=color:#ff79c6>const</span> cachedtime <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>this</span>.cachedDigestDate.getTime();
    <span style=color:#ff79c6>const</span> difference <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>Math</span>.abs(cachedtime <span style=color:#ff79c6>-</span> today);
    <span style=color:#ff79c6>const</span> seconds <span style=color:#ff79c6>=</span> (difference <span style=color:#ff79c6>/</span> <span style=color:#bd93f9>1000</span>) <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>60</span>;
    <span style=color:#ff79c6>return</span> seconds <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>60</span>;
  }
</code></pre></div><p>The easy usage is:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts>  addSiteGroupContributor(<span style=color:#f1fa8c>&#39;Everyone&#39;</span>)
</code></pre></div><div class=post-author><div class=author-img><img alt="Mathias Osterkamp" src=https://conception365.com/img/mathiasosterkamp_half.png class="avatar avatar-100 photo" height=100 width=100></div><div class=author-content><h5><a href=/top/about/ title="Written by Mathias Osterkamp" rel=author>Mathias Osterkamp</a></h5><p>I've been working for about 12 years with a thematic focus on 'Collaboration' and 'Digital Transformation' especially in the product environment Microsoft on the topics Office 365, SharePoint, Azure and general web development.</p></div></div><ul class=pager><li class=previous><a href=https://conception365.com/post/2021-08-31-spfx-showcase-mysite/ data-toggle=tooltip data-placement=top title="SPFX Showcase - MySite">&larr;
Previous Post<div class=pager-title>SPFX Showcase - MySite</div></a></li><li class=next><a href=https://conception365.com/post/2021-11-01-powershell-create-navigation/ data-toggle=tooltip data-placement=top title="Powershell - Create Navigation">Next
Post &rarr;<div class=pager-title>Powershell - Create Navigation</div></a></li></ul><br><script src=https://utteranc.es/client.js repo=MathiasOsterkamp/conception365-com issue-term=url label=question theme=github-light crossorigin=anonymous issue-term=pathname async></script></div><div class="col-lg-4
col-md-4
sidebar-container"><h5>TOC</h5><nav id=TableOfContents><ul><li><a href=#add-site-collection-term-group-managers-and-contributors-using-jsom>Add site collection term group Managers and Contributors using JSOM</a></li></ul></nav><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/tags/managed-metadata title=managed-metadata>managed-metadata</a>
<a href=/tags/pnp title=pnp>pnp</a>
<a href=/tags/powerapps title=powerapps>powerapps</a>
<a href=/tags/powershell title=powershell>powershell</a>
<a href=/tags/sevdesk title=sevdesk>sevdesk</a>
<a href=/tags/sharepoint title=sharepoint>sharepoint</a>
<a href=/tags/sp2019 title=sp2019>sp2019</a>
<a href=/tags/spfx title=spfx>spfx</a></div></section><section><hr><h5>RECENT POSTS</h5><ul class=side-newsfeed><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2021-11-01-powershell-create-navigation/ title="Powershell - Create Navigation" style=display:inline-block;background-image:url(/post/2021-11-01-powershell-create-navigation/header_hu57fad8182e36ba611e1f4a15b5e0c725_73932_120x0_resize_box_2.png)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2021-11-01-powershell-create-navigation/ rel=bookmark title="Powershell - Create Navigation">Powershell - Create Navigation</a></h4><span class=side-item-meta><time class="entry-date published">Monday, November 1, 2021</time></span></div></div></li><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2021-10-22-jsom-termgroup-add-contributor/ title="Site termgroup add contributor or manager" style=display:inline-block;background-image:url(/post/2021-10-22-jsom-termgroup-add-contributor/header_huf4a0530713166702484ca9ce582083fb_54113_120x0_resize_box_2.png)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2021-10-22-jsom-termgroup-add-contributor/ rel=bookmark title="Site termgroup add contributor or manager">Site termgroup add contributor or manager</a></h4><span class=side-item-meta><time class="entry-date published">Friday, October 22, 2021</time></span></div></div></li><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2021-08-31-spfx-showcase-mysite/ title="SPFX Showcase - MySite" style=display:inline-block;background-image:url(/post/2021-08-31-spfx-showcase-mysite/header_hu08cc3da8430171f206449dcc5b7e02bb_59082_120x0_resize_box_2.png)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2021-08-31-spfx-showcase-mysite/ rel=bookmark title="SPFX Showcase - MySite">SPFX Showcase - MySite</a></h4><span class=side-item-meta><time class="entry-date published">Tuesday, August 31, 2021</time></span></div></div></li><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2021-08-13-spfx-2019-pnpm/ title="SPFX 2019 - speed up npm performance" style=display:inline-block;background-image:url(/post/2021-08-13-spfx-2019-pnpm/header_hucad760f47b2bf2a2bf8c8cbc7d6484e3_1088333_120x0_resize_q75_box.jpg)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2021-08-13-spfx-2019-pnpm/ rel=bookmark title="SPFX 2019 - speed up npm performance">SPFX 2019 - speed up npm performance</a></h4><span class=side-item-meta><time class="entry-date published">Friday, August 13, 2021</time></span></div></div></li><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2021-07-23-spse-first-review/ title="SharePoint Server Subscription Edition - First Review" style=display:inline-block;background-image:url(/post/2021-07-23-spse-first-review/header_hu4d9cda49ec06a7a986bf26a11c48cf59_23074_120x0_resize_box_2.png)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2021-07-23-spse-first-review/ rel=bookmark title="SharePoint Server Subscription Edition - First Review">SharePoint Server Subscription Edition - First Review</a></h4><span class=side-item-meta><time class="entry-date published">Friday, July 23, 2021</time></span></div></div></li></ul></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href rel=alternate type=application/rss+xml title="Mathias Osterkamp"><span class=fa-stack><i class="fas fa-rss"></i></span>
RSS</a></li><li><a href=mailto:mathias.osterkamp@conception365.com><span class=fa-stack><i class="fas fa-envelope"></i></span>
Email</a></li><li><a href=/top/impressum/><span>Impressum</span></a></li><li><a href=/top/privacy/><span>Privacy Policy</span></a></li></ul><p class="copyright text-muted">Copyright &copy; Mathias Osterkamp 2021</p></div></div></div></footer></body></html>