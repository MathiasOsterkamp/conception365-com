<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Mathias Osterkamp"><meta property="og:type" content="article"><meta property="og:image" content="https://conception365.com/"><meta property="twitter:image" content="https://conception365.com/"><meta name=title content="Remove Managed Metadata Orphaned Terms"><meta property="og:title" content="Remove Managed Metadata Orphaned Terms"><meta property="twitter:title" content="Remove Managed Metadata Orphaned Terms"><meta name=description content><meta property="og:description" content><meta property="twitter:description" content><meta property="twitter:card" content="summary"><meta name=keyword content="SharePoint, Microsoft, Office 365, Teams, Azure, Webdevelopment"><link rel="shortcut icon" href=/img/favicon.ico><title>Remove Managed Metadata Orphaned Terms-Mathias Osterkamp</title><link rel=canonical href=/post/2021-02-11-orphaned-terms/><link rel=stylesheet href=https://conception365.com/main.min.a0caedcc7922d0617da6542be4c49270e66f8f00a85b75c5e7678b10d402bbb1.css><script type=text/javascript src=/js/bundle.min.e459528320f58ffacd1d26c997631f04a7c3d2ff4f6408fe8e3bc5b970f96fae.js defer></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JG6K5XRGQL"></script><script>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-JG6K5XRGQL',{anonymize_ip:!0})}</script></head><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=site-heading><h1>Mathias Osterkamp</h1><span class=subheading>Specialist – focus development Microsoft technology stack</span></div></div></div></div></header><nav class="navbar navbar-default navbar-custom"><div class=container><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/categories/administration>administration</a></li><li><a href=/categories/powerapps>powerapps</a></li><li><a href=/categories/spfx>spfx</a></li><li><a href=/top/about/>ABOUT ME</a></li></ul><ul class="nav navbar-nav navbar-right"><li><a href=/search>SEARCH <img src=/img/search.png height=15 style=cursor:pointer alt=Search></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector('.navbar-toggle'),$navbar=document.querySelector('#huxblog_navbar'),$collapse=document.querySelector('.navbar-collapse');$toggle.addEventListener('click',handleMagic);function handleMagic(a){$navbar.className.indexOf('in')>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf('in')<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><article><div class=container><div class=row><div class="col-lg-8
col-md-8
post-container"><div class=post-preview><div class=penci-standard-cat><span class=cat><a class=penci-cat-name href=https://conception365.com/tags/sp2019/ rel="category tag">SP2019</a>
<a class=penci-cat-name href=https://conception365.com/tags/powershell/ rel="category tag">Powershell</a>
<a class=penci-cat-name href=https://conception365.com/tags/pnp/ rel="category tag">PNP</a>
<a class=penci-cat-name href=https://conception365.com/tags/managed-metadata/ rel="category tag">Managed Metadata</a></span></div><a href=https://conception365.com/post/2021-02-11-orphaned-terms/><h2 class=post-title>Remove Managed Metadata Orphaned Terms</h2></a><h2 class=post-subtitle>Remove with PowerShell</h2><span class=post-meta>Written by
Mathias Osterkamp
on
Thursday, February 11, 2021</span></div><h1 id=remove-managed-metadata-orphaned-terms>Remove Managed Metadata Orphaned Terms</h1><h2 id=problem>Problem</h2><p>In some cases you like to get rid of orphaned terms. Terms mostly get orphaned, if you reuse terms and delete the original instances. There is a very good explanation from <a href=http://www.migee.com/2015/08/03/sharepoint-why-you-might-have-irremovable-orphaned-terms/>Mike Morawski</a> how this could happen.</p><blockquote><p>Not long ago I was working away with the term store though Powershell.
I had to remove all of a particular group’s termsets and to do this I
ended up calling the Group’s
<a href=https://msdn.microsoft.com/EN-US/library/microsoft.sharepoint.taxonomy.group.delete.aspx>delete</a>
function. It appeared to work just fine, until I later found that I
was unable to import terms with GUID’s used previously. This is
somewhat of a common problem that developers will come across if they
are saving certain terms or termsets and trying to reimport while the
others with the same ID still exist.</p><p>However, in this case, the entire term store was empty, until I
realized that orphaned terms exist. For those of you who do not know
the managed metadata service too well, orphaned terms will be created
when deleting a term that was reused/pinned elsewhere. Because the
original term that the ‘duplicates’ reference doesn’t exist anymore,
the terms become orphans and they reside in the <strong>system group</strong>.</p><p>These orphaned terms get removed automatically when the duplicates are
removed. <em>Supposedly</em>.</p><p>There appears to be a bug when removing a group through code where in
certain cases the orphans never seem to be checked whether or not the
duplicates have all been cleaned up. Through code I had to remove
termsets one by one, using the group.termsets property, then commit.
It seems that trying to do everything in one commit can cause this.</p><p>Notice that the member of area indicates that there are no other terms
using this as a reference, yet it still exists!</p><p>As far as removing the orphaned terms go, I was unable to actually
target these terms through code as I would have the following error:</p><blockquote><p><em>This operation is invalid in the Orphaned Terms term set.</em></p></blockquote><p>Unfortunately I believe this leaves the MMS in a slightly corrupt
state, it will still function so long as those GUID’s for the orphans
are never used again. I ended up starting fresh because I fortunately
ran into this before the code left the development server.</p><p>I wish I could say more about this issue after the fact however this
is all I can say for the time being. If you really need to remove
these orphans, an idea I had a the time was to create a duplicate of
that orphan through code, then remove manually though the interface
and see if that causes some sort of event receiver to run through and
clear the source term (orphan).</p></blockquote><p>You can also find some more details about general deleting of terms <a href=https://sharepointmaven.com/how-to-properly-delete-and-hide-managed-metadata-terms-in-the-term-store/>source</a>.</p><h2 id=solution>Solution</h2><p>There is a easy solution by deleting the terms with <a href="https://docs.microsoft.com/de-de/powershell/sharepoint/sharepoint-pnp/sharepoint-pnp-cmdlets?view=sharepoint-ps">PNP Powershell</a>. Prepare your environment:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=color:#8be9fd;font-style:italic>Install-Module</span> -Name PnP.PowerShell
</code></pre></div><p>Delete your terms:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1>
<span style=color:#8be9fd;font-style:italic>$session</span> = <span style=color:#8be9fd;font-style:italic>Get-PnPTaxonomySession</span>
<span style=color:#8be9fd;font-style:italic>$termStore</span> = <span style=color:#8be9fd;font-style:italic>$session</span>.TermStores[0]
<span style=color:#8be9fd;font-style:italic>$termSet</span> = <span style=color:#8be9fd;font-style:italic>Get-PnPTermSet</span> -Identity <span style=color:#f1fa8c>&#34;Orphaned Terms&#34;</span> -TermGroup <span style=color:#f1fa8c>&#34;System&#34;</span> -Includes <span style=color:#f1fa8c>&#34;Terms&#34;</span>
<span style=color:#ff79c6>if</span> (<span style=color:#8be9fd;font-style:italic>$termSet</span>) {
  <span style=color:#8be9fd;font-style:italic>$terms</span> = <span style=color:#8be9fd;font-style:italic>$termSet</span>.Terms
  <span style=color:#8be9fd;font-style:italic>$terms</span> | <span style=color:#ff79c6>ForEach</span>-Object { 
    <span style=color:#8be9fd;font-style:italic>$_</span>.DeleteObject() 
  }
  <span style=color:#8be9fd;font-style:italic>$termStore</span>.CommitAll();
  <span style=color:#8be9fd;font-style:italic>Invoke-PnPQuery</span>
}

</code></pre></div><p>Thats everything!</p><div class=post-author><div class=author-img><img alt="Mathias Osterkamp" src=https://conception365.comimg/mathiasosterkamp_half.png class="avatar avatar-100 photo" height=100 width=100></div><div class=author-content><h5><a href=/top/about/ title="Written by Mathias Osterkamp" rel=author>Mathias Osterkamp</a></h5><p>I've been working for about 10 years with a thematic focus on 'Collaboration' and 'Digital Transformation' especially in the product environment Microsoft on the topics Office 365, SharePoint, Azure and general web development.</p></div></div><hr><ul class=pager><li class=previous><a href=https://conception365.com/post/2020-12-12-managed-metadata-migration/ data-toggle=tooltip data-placement=top title="Managed Metadata Migration">&larr;
Previous Post</a></li><li class=next><a href=https://conception365.com/post/2021-04-22-spfx-2019-prettier-eslint/ data-toggle=tooltip data-placement=top title="SPFX 2019 eslint and prettier">Next
Post &rarr;</a></li></ul><div id=disqus-comment></div></div><div class="col-lg-4
col-md-4
sidebar-container"><h5>TOC</h5><nav id=TableOfContents><ul><li><a href=#remove-managed-metadata-orphaned-terms>Remove Managed Metadata Orphaned Terms</a><ul><li><a href=#problem>Problem</a></li><li><a href=#solution>Solution</a></li></ul></li></ul></nav><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/tags/managed-metadata title=managed-metadata>managed-metadata</a>
<a href=/tags/sp2019 title=sp2019>sp2019</a></div></section><section class="visible-md visible-lg"><hr><h5><a href=/top/about>ABOUT ME</a></h5><div class=short-about><a href=/top/about><img src=/img/mathiasosterkamp_half.png alt=avatar style=cursor:pointer></a><p>I've been working for about 10 years with a thematic focus on 'Collaboration' and 'Digital Transformation' especially in the product environment Microsoft on the topics Office 365, SharePoint, Azure and general web development.</p></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href rel=alternate type=application/rss+xml title="Mathias Osterkamp"><span class=fa-stack><i class="fas fa-rss"></i></span>
RSS</a></li><li><a href=mailto:mathias.osterkamp@conception365.com><span class=fa-stack><i class="fas fa-envelope"></i></span>
Email</a></li><li><a href=/top/impressum/><span>Impressum</span></a></li><li><a href=/top/privacy/><span>Privacy Policy</span></a></li></ul><p class="copyright text-muted">Copyright &copy; Mathias Osterkamp 2021</p></div></div></div></footer></body></html>