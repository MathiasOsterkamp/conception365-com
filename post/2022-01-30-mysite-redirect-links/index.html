<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Mathias Osterkamp"><meta property="og:type" content="article"><meta property="og:image" content="/post/2022-01-30-mysite-redirect-links/header_hu1fc9044e0354cb91afb2b35d3c05b456_3585475_350x0_resize_box_2.png"><meta property="twitter:image" content="/post/2022-01-30-mysite-redirect-links/header_hu1fc9044e0354cb91afb2b35d3c05b456_3585475_350x0_resize_box_2.png"><meta name=title content="Mysite - Redirects"><meta property="og:title" content="Mysite - Redirects"><meta property="twitter:title" content="Mysite - Redirects"><meta name=description content><meta property="og:description" content><meta property="twitter:description" content><meta property="twitter:card" content="summary"><meta name=keyword content="SharePoint, Microsoft, Office 365, Teams, Azure, Webdevelopment"><link rel="shortcut icon" href=/%20img/favicon.ico><title>Mysite - Redirects-Mathias Osterkamp</title><link rel=canonical href=/post/2022-01-30-mysite-redirect-links/><link rel=preload href=fonts/jost/files/jost-latin-200-normal.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=fonts/jost/files/jost-latin-400-normal.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=fonts/jost/files/jost-latin-500-normal.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://conception365.com/main.min.50bc48d2b178bdf1d99650adf9577e5e15189f3c08648f97cf6e84b934bf36bc.css><script type=text/javascript src=/js/bundle.min.e459528320f58ffacd1d26c997631f04a7c3d2ff4f6408fe8e3bc5b970f96fae.js defer></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JG6K5XRGQL"></script><script>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-JG6K5XRGQL',{anonymize_ip:!0})}</script><script async src=http://localhost:3000/tracker.js data-ackee-server=http://localhost:3000 data-ackee-opts='{ "ignoreLocalhost": false,"ignoreOwnVisits": false, "detailed": true }' data-ackee-domain-id=8d8a9a93-b756-432f-b199-8df069f35faf></script></head><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=site-heading><a href=https://conception365.com><h1>Mathias Osterkamp</h1></a><span class=subheading>Specialist â€“ focus development Microsoft technology stack</span></div></div></div></div></header><nav class="navbar navbar-default navbar-custom"><div class=container><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/categories/administration>administration</a></li><li><a href=/categories/powerapps>powerapps</a></li><li><a href=/categories/spfx>spfx</a></li><li><a href=/top/about/>ABOUT ME</a></li></ul><ul class="nav navbar-nav navbar-right"><li><a href=/search>SEARCH <img src=/img/search.png height=15 style=cursor:pointer alt=Search></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector('.navbar-toggle'),$navbar=document.querySelector('#huxblog_navbar'),$collapse=document.querySelector('.navbar-collapse');$toggle.addEventListener('click',handleMagic);function handleMagic(a){$navbar.className.indexOf('in')>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf('in')<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><article><div class=container><div class=row><div class="col-lg-8
col-md-8
post-container"><div class=post-preview><div class=penci-standard-cat><span class=cat><a class=penci-cat-name href=https://conception365.com/tags/sp2019/ rel="category tag">SP2019</a>
<a class=penci-cat-name href=https://conception365.com/tags/iis/ rel="category tag">IIS</a>
<a class=penci-cat-name href=https://conception365.com/tags/onpremise/ rel="category tag">OnPremise</a></span></div><a href=https://conception365.com/post/2022-01-30-mysite-redirect-links/><h2 class=post-title>Mysite - Redirects</h2></a><h2 class=post-subtitle>Redirect Mysite to a modern Page</h2><span class=post-meta>Written by
Mathias Osterkamp
on
Sunday, January 30, 2022</span>
<a href=header.png target=_blank><img src=/post/2022-01-30-mysite-redirect-links/header_hu1fc9044e0354cb91afb2b35d3c05b456_3585475_800x0_resize_box_2.png></a></div><h1 id=redirect-mysite-to-a-modern-page>Redirect Mysite to a modern Page</h1><h2 id=goal>Goal</h2><p>SharePoint 2019 OnPremise has still the classic MySite. To support a modern page you could build it on top of the default MySite host, but this is not the best way. With a redirect based solution you don&rsquo;t change anything to existing code. Just build your new MySite features on a new page on a different WebApplication and SiteCollection based on modern theme. All important links should be redirected.</p><h2 id=possible-solutions>Possible Solutions</h2><p>To get your MySite pages redirected you face one problem. It is not only the default.aspx on MySite Host, there are several more pages especial on the user generated personal site collections. (ex. <a href=https://mysite.contoso.com/personal/>https://mysite.contoso.com/personal/</a>&#171;loginname&#187;/&mldr;)</p><h3 id=iis-redirect>IIS Redirect</h3><p>Best solution is to use the features of IIS URL Rewrite Module. It has to be installed first on every SharePoint frontend server:</p><p>URL Rewrite Module 2.1: <a href=https://www.iis.net/downloads/microsoft/url-rewrite>https://www.iis.net/downloads/microsoft/url-rewrite</a></p><p>Advantages:</p><ul><li><p>Supported by Microsoft: <a href=https://support.microsoft.com/en-us/office/supportability-of-rewrites-and-redirects-in-sharepoint-2016-2013-2010-and-2007-a74a19f2-a59a-4b39-8be4-ce63e50139fa>Source</a></p><blockquote><p>HTTP REDIRECT</p><p>Client makes a request to <a href=http://www.contoso.com/sites/site1>http://www.contoso.com/sites/site1</a>.
IIS with ARR receives the request to <a href=http://www.contoso.com/sites/site1>http://www.contoso.com/sites/site1</a>.
ARR uses URL Rewrite to create a redirect to <a href=http://www.fabrikam.com/sites/site1,>http://www.fabrikam.com/sites/site1,</a> and then returns the HTTP redirect (for example, 301 or 302) to the client
Client receives the redirect, and then makes a new request by using the new URL: <a href=http://www.fabrikam.com/sites/site1>http://www.fabrikam.com/sites/site1</a>.
SharePoint receives the request, and processes it as usual.</p><p>This scenario is <strong>SUPPORTED.</strong></p></blockquote></li><li><p>Fast solution with client site permanent redirect</p></li><li><p>Tested solution</p></li><li><p>Complex regex rules possible</p></li></ul><p>Disadvantages:</p><ul><li>No permission based redirect, you had to implement a permission based logic on target page</li></ul><h3 id=http-handler>HTTP Handler</h3><p>With a Http Handler you can access every request in IIS to add some custom logic.(<a href="https://docs.microsoft.com/en-us/previous-versions/office/developer/sharepoint-services/bb457204(v=office.12)?redirectedfrom=MSDN">Sample</a>)</p><p>Code from stack overflow to demonstrate the basic solution <a href=https://stackoverflow.com/questions/2598622/using-custom-httphandler-to-redirect-users-in-sharepoint>link</a> :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#ff79c6>&lt;add</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;CustomHttpModule&#34;</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;CustomHttpModule.HttpModuleImplementation, CustomHttpModule&#34;</span> <span style=color:#ff79c6>/&gt;</span>
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=color:#ff79c6>using</span> System;
<span style=color:#ff79c6>using</span> System.Web;
<span style=color:#ff79c6>using</span> System.Web.UI;
<span style=color:#ff79c6>using</span> System.Configuration;
<span style=color:#ff79c6>using</span> Microsoft.Practices.EnterpriseLibrary.Data;
<span style=color:#ff79c6>using</span> System.Data;

<span style=color:#ff79c6>namespace</span> CustomHttpModule
{
    <span style=color:#ff79c6>public</span> <span style=color:#ff79c6>class</span> <span style=color:#50fa7b>HttpModuleImplementation</span> : IHttpModule
    {
        <span style=color:#ff79c6>#region IHttpModule Members
</span><span style=color:#ff79c6></span>
        <span style=color:#ff79c6>public</span> <span style=color:#ff79c6>void</span> Dispose()
        {

        }

        <span style=color:#ff79c6>public</span> <span style=color:#ff79c6>void</span> Init(HttpApplication context)
        {
            <span style=color:#ff79c6>if</span> (context == <span style=color:#ff79c6>null</span>)
                <span style=color:#ff79c6>throw</span> <span style=color:#ff79c6>new</span> ArgumentNullException(<span style=color:#f1fa8c>&#34;Context == null&#34;</span>);

            context.AuthorizeRequest += <span style=color:#ff79c6>new</span> EventHandler(<span style=color:#ff79c6>this</span>.ProcessRequestHandler);
        }
        <span style=color:#ff79c6>#endregion
</span><span style=color:#ff79c6></span>
        <span style=color:#ff79c6>private</span> <span style=color:#ff79c6>void</span> DummpRequest(<span style=color:#8be9fd>object</span> sender, EventArgs e)
        {
        }
        <span style=color:#6272a4>//first check that user.identity record exist in database
</span><span style=color:#6272a4></span>        <span style=color:#6272a4>//If not then forward user to User registration page
</span><span style=color:#6272a4></span>        <span style=color:#ff79c6>private</span> <span style=color:#ff79c6>void</span> ProcessRequestHandler(<span style=color:#8be9fd>object</span> sender, EventArgs e)
        {
            <span style=color:#ff79c6>try</span>
            {
                HttpApplication context = (HttpApplication)sender;
                <span style=color:#8be9fd>string</span> strAbsoluteUri = context.Request.Url.AbsoluteUri.ToLower();
                <span style=color:#6272a4>//check if request is accessing aspx page
</span><span style=color:#6272a4></span>                <span style=color:#ff79c6>if</span> (strAbsoluteUri.Substring(strAbsoluteUri.Length - <span style=color:#bd93f9>5</span>, <span style=color:#bd93f9>5</span>).Contains(<span style=color:#f1fa8c>&#34;.aspx&#34;</span>))
                {
                    <span style=color:#8be9fd>string</span> userName = context.User.Identity.Name;
                    <span style=color:#6272a4>//replace Test Module with DB call to validate user data
</span><span style=color:#6272a4></span>                    <span style=color:#ff79c6>if</span> (!CheckUserInDb(userName))
                    {
                        <span style=color:#ff79c6>if</span> (!strAbsoluteUri.Contains(<span style=color:#f1fa8c>&#34;mypage.aspx&#34;</span>))
                            redirectToRegistrationPage(context);
                    }
                }
            }
            <span style=color:#ff79c6>catch</span> (Exception ex)
            {
            }
        }
        <span style=color:#ff79c6>private</span> <span style=color:#ff79c6>void</span> redirectToRegistrationPage(HttpApplication context)
        {
            context.Response.Redirect(<span style=color:#f1fa8c>&#34;http://&#34;</span> + context.Request.ServerVariables[<span style=color:#f1fa8c>&#34;HTTP_HOST&#34;</span>].ToString() + <span style=color:#f1fa8c>&#34;Regpage.aspx&#34;</span>, <span style=color:#ff79c6>false</span>);
        }

        <span style=color:#ff79c6>private</span> <span style=color:#8be9fd>bool</span> CheckUserInDb(<span style=color:#8be9fd>string</span> userName)
        {
                    <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>true</span>;
        }
    }
}
</code></pre></div><p>Advantages:</p><ul><li>Support for complex rules and permission based redirects</li></ul><p>Disadvantages:</p><ul><li>SharePoint Solution needed</li><li>A lot of work to make good implementation</li><li>Rules have to be stored</li><li>Untested</li><li>Slow</li></ul><h3 id=modify-pages>Modify Pages</h3><p>You also can modify each target page to add some redirect logic for example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#ff79c6>&lt;meta</span> <span style=color:#50fa7b>http-equiv=</span><span style=color:#f1fa8c>&#34;refresh&#34;</span> <span style=color:#50fa7b>content=</span><span style=color:#f1fa8c>&#34;0;url=https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
</code></pre></div><p>Advantages:</p><ul><li>Modify only specific pages</li></ul><p>Disadvantages:</p><ul><li>You can not modify system pages like &ldquo;Edit Profile&rdquo;</li><li>No easy way to redirect personal pages</li></ul><h2 id=pages-for-consideration>Pages for consideration</h2><p>Following pages should be under consideration:</p><table><thead><tr><th>Title</th><th style=text-align:left>Regex</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td>DefaultMySite</td><td style=text-align:left>^default.aspx</td><td style=text-align:left>About me</td></tr><tr><td>PersonMySite</td><td style=text-align:left>person.aspx</td><td style=text-align:left>Activities</td></tr><tr><td>MyPeopleMySite</td><td style=text-align:left>mypeople.aspx</td><td style=text-align:left>Newsfeed entries</td></tr><tr><td>Documents</td><td style=text-align:left>personal/\w*/_layouts/15/onedrive.aspx</td><td style=text-align:left>Onedrive documents</td></tr><tr><td>Blog</td><td style=text-align:left>personal/\w*/Blog/*</td><td style=text-align:left>Personal blog</td></tr><tr><td>Personal_Default</td><td style=text-align:left>personal/\w*/default.aspx</td><td style=text-align:left>Personal newsfeed</td></tr><tr><td>AddApp</td><td style=text-align:left>personal/\w*/_layouts/15/addanapp.aspx</td><td style=text-align:left>Add apps to mysite</td></tr><tr><td>Newsbweb</td><td style=text-align:left>personal/\w*/_layouts/15/newsbweb.aspx</td><td style=text-align:left>Create new subsites</td></tr><tr><td>Sitemanager</td><td style=text-align:left>personal/\w*/_layouts/15/sitemanager.aspx</td><td style=text-align:left>Site Manager</td></tr><tr><td>SocialSites</td><td style=text-align:left>personal/\w*/Social/Sites.aspx</td><td style=text-align:left>Followed sites</td></tr><tr><td>FollowedDocumentsSites</td><td style=text-align:left>personal/\w*/Social/FollowedContent.aspx</td><td style=text-align:left>Followed documents</td></tr><tr><td>SharePointHome</td><td style=text-align:left>_layouts/15/sharepoint.aspx</td><td style=text-align:left>Followed site activities</td></tr><tr><td>Quicklinks</td><td style=text-align:left>_layouts/15/MyQuickLinks.aspx</td><td style=text-align:left>Quick links</td></tr><tr><td>HashTags</td><td style=text-align:left>_layouts/15/HashTagProfile.aspx</td><td style=text-align:left>Followed HashTag Newsfeeds</td></tr></tbody></table><h2 id=iis-redirect-rules>IIS Redirect Rules</h2><p>What also should work is to redirect other accounts. So we still keep url parameters (default for iis rules):</p><p>&mldr;/person.aspx?accountname=&#171;loginname&#187; > &mldr;/Sites/Home.aspx?accountname=&#171;loginname&#187;</p><p>You can also create a url parameter to stop redirect, if you like still have an access possibility. For example <a href="https://mysite.contoso.com/default.aspx?stopredirect=1">https://mysite.contoso.com/default.aspx?stopredirect=1</a> :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#ff79c6>&lt;conditions&gt;</span>
    <span style=color:#ff79c6>&lt;add</span> <span style=color:#50fa7b>input=</span><span style=color:#f1fa8c>&#34;{QUERY_STRING}&#34;</span> <span style=color:#50fa7b>pattern=</span><span style=color:#f1fa8c>&#34;stopredirect=1&#34;</span> <span style=color:#50fa7b>negate=</span><span style=color:#f1fa8c>&#34;true&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/conditions&gt;</span>
</code></pre></div><p>Here is a list of important rules:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_Default_MySite&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;^default\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_Person_MySite&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;person\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_MyPeople_MySite&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;mypeople\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_OneDrive&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;personal\/\w*\/_layouts/15/onedrive\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_Blog&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;personal\/\w*\/Blog\/\*&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span><span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_Personal_Default&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;personal\/\w*\/default\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span><span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_AddApp&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;personal\/\w*\/_layouts/15/addanapp\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span><span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_Newsbweb&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;personal\/\w*\/_layouts/15/newsbweb\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span><span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Blocken_Sitemanager&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;personal\/\w*\/_layouts/15/sitemanager\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span><span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_SocialSites&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;personal\/\w*\/Social/Sites\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_FollowedDocumentSites&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;personal\/\w*\/Social/FollowedContent\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_SharePointHome&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;_layouts/15/sharepoint\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_Quicklinks&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;_layouts/15/MyQuickLinks\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
<span style=color:#ff79c6>&lt;rule</span> <span style=color:#50fa7b>name=</span><span style=color:#f1fa8c>&#34;Redirect_HashTags&#34;</span> <span style=color:#50fa7b>stopProcessing=</span><span style=color:#f1fa8c>&#34;true&#34;</span><span style=color:#ff79c6>&gt;</span>
    <span style=color:#ff79c6>&lt;match</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;_layouts/15/HashTagProfile\.aspx&#34;</span> <span style=color:#ff79c6>/&gt;</span>
    <span style=color:#ff79c6>&lt;action</span> <span style=color:#50fa7b>type=</span><span style=color:#f1fa8c>&#34;Redirect&#34;</span> <span style=color:#50fa7b>url=</span><span style=color:#f1fa8c>&#34;https://sharepoint.contoso.com/Sites/Home.aspx&#34;</span> <span style=color:#50fa7b>redirectType=</span><span style=color:#f1fa8c>&#34;Permanent&#34;</span> <span style=color:#ff79c6>/&gt;</span>
<span style=color:#ff79c6>&lt;/rule&gt;</span>
</code></pre></div><p>More documentation from Microsoft here:
<a href=https://docs.microsoft.com/en-us/iis/extensions/url-rewrite-module/creating-rewrite-rules-for-the-url-rewrite-module>https://docs.microsoft.com/en-us/iis/extensions/url-rewrite-module/creating-rewrite-rules-for-the-url-rewrite-module</a></p><div class=post-author><div class=author-img><img alt="Mathias Osterkamp" src=https://conception365.com/img/mathiasosterkamp_half.png class="avatar avatar-100 photo" height=100 width=100></div><div class=author-content><h5><a href=/top/about/ title="Written by Mathias Osterkamp" rel=author>Mathias Osterkamp</a></h5><p>I've been working for about 12 years with a thematic focus on 'Collaboration' and 'Digital Transformation' especially in the product environment Microsoft on the topics Office 365, SharePoint, Azure and general web development.</p></div></div><ul class=pager><li class=previous><a href=https://conception365.com/post/2021-11-01-powershell-create-navigation/ data-toggle=tooltip data-placement=top title="Powershell - Create Navigation">&larr;
Previous Post<div class=pager-title>Powershell - Create Navigation</div></a></li></ul><br></div><div class="col-lg-4
col-md-4
sidebar-container"><h5>TOC</h5><nav id=TableOfContents><ul><li><a href=#redirect-mysite-to-a-modern-page>Redirect Mysite to a modern Page</a><ul><li><a href=#goal>Goal</a></li><li><a href=#possible-solutions>Possible Solutions</a></li><li><a href=#pages-for-consideration>Pages for consideration</a></li><li><a href=#iis-redirect-rules>IIS Redirect Rules</a></li></ul></li></ul></nav><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/tags/managed-metadata title=managed-metadata>managed-metadata</a>
<a href=/tags/onpremise title=onpremise>onpremise</a>
<a href=/tags/pnp title=pnp>pnp</a>
<a href=/tags/powerapps title=powerapps>powerapps</a>
<a href=/tags/powershell title=powershell>powershell</a>
<a href=/tags/sevdesk title=sevdesk>sevdesk</a>
<a href=/tags/sharepoint title=sharepoint>sharepoint</a>
<a href=/tags/sp2019 title=sp2019>sp2019</a>
<a href=/tags/spfx title=spfx>spfx</a></div></section><section><hr><h5>RECENT POSTS</h5><ul class=side-newsfeed><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2022-01-30-mysite-redirect-links/ title="Mysite - Redirects" style=display:inline-block;background-image:url(/post/2022-01-30-mysite-redirect-links/header_hu1fc9044e0354cb91afb2b35d3c05b456_3585475_120x0_resize_box_2.png)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2022-01-30-mysite-redirect-links/ rel=bookmark title="Mysite - Redirects">Mysite - Redirects</a></h4><span class=side-item-meta><time class="entry-date published">Sunday, January 30, 2022</time></span></div></div></li><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2021-11-01-powershell-create-navigation/ title="Powershell - Create Navigation" style=display:inline-block;background-image:url(/post/2021-11-01-powershell-create-navigation/header_hu57fad8182e36ba611e1f4a15b5e0c725_73932_120x0_resize_box_2.png)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2021-11-01-powershell-create-navigation/ rel=bookmark title="Powershell - Create Navigation">Powershell - Create Navigation</a></h4><span class=side-item-meta><time class="entry-date published">Monday, November 1, 2021</time></span></div></div></li><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2021-10-22-jsom-termgroup-add-contributor/ title="Site termgroup add contributor or manager" style=display:inline-block;background-image:url(/post/2021-10-22-jsom-termgroup-add-contributor/header_huf4a0530713166702484ca9ce582083fb_54113_120x0_resize_box_2.png)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2021-10-22-jsom-termgroup-add-contributor/ rel=bookmark title="Site termgroup add contributor or manager">Site termgroup add contributor or manager</a></h4><span class=side-item-meta><time class="entry-date published">Friday, October 22, 2021</time></span></div></div></li><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2021-08-31-spfx-showcase-mysite/ title="SPFX Showcase - MySite" style=display:inline-block;background-image:url(/post/2021-08-31-spfx-showcase-mysite/header_hu08cc3da8430171f206449dcc5b7e02bb_59082_120x0_resize_box_2.png)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2021-08-31-spfx-showcase-mysite/ rel=bookmark title="SPFX Showcase - MySite">SPFX Showcase - MySite</a></h4><span class=side-item-meta><time class="entry-date published">Tuesday, August 31, 2021</time></span></div></div></li><li class=penci-feed><div class=side-item><div class=side-image><a class="penci-image-holder penci-lazy small-fix-size" rel=bookmark href=https://conception365.com/post/2021-08-13-spfx-2019-pnpm/ title="SPFX 2019 - speed up npm performance" style=display:inline-block;background-image:url(/post/2021-08-13-spfx-2019-pnpm/header_hucad760f47b2bf2a2bf8c8cbc7d6484e3_1088333_120x0_resize_q75_box.jpg)></a></div><div class=side-item-text><h4 class=side-title-post><a href=https://conception365.com/post/2021-08-13-spfx-2019-pnpm/ rel=bookmark title="SPFX 2019 - speed up npm performance">SPFX 2019 - speed up npm performance</a></h4><span class=side-item-meta><time class="entry-date published">Friday, August 13, 2021</time></span></div></div></li></ul></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href rel=alternate type=application/rss+xml title="Mathias Osterkamp"><span class=fa-stack><i class="fas fa-rss"></i></span>
RSS</a></li><li><a href=mailto:mathias.osterkamp@conception365.com><span class=fa-stack><i class="fas fa-envelope"></i></span>
Email</a></li><li><a href=/top/impressum/><span>Impressum</span></a></li><li><a href=/top/privacy/><span>Privacy Policy</span></a></li></ul><p class="copyright text-muted">Copyright &copy; Mathias Osterkamp 2022</p></div></div></div></footer></body></html>